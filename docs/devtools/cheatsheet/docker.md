# Docker Commands

> Docker is an open source platform that enables developers to build & deploy containers that combines application source code with OS, libraries and dependencies required to run that code.

## Docker Objects

- Images: read only template with instructions for crating docker containers.
- Container: running instance of a docker image
- Network: network interface used to connect the containers to each other or external networks
- Volumes: used to persist the data generated by and used by the containers
- Registry: private or public collection of docker images
- Service: used to deploy application in a docker multi node cluster

### Image Commands

```docker

# get the list of images available on the machine
> docker image ls

# download or pull the image on the machine
# > docker image pull <image name>
# the image gets stored in /var/lib/docker/images directory
> docker image pull hello-world

# remove image from machine
# > docker image rm <image name>
> docker image rm hello-world

# get information about an image
> docker image inspect hello-world
```


### Container Commands

```

# get the list of running containers
> docker container ls

# get the list of containers in all states (created, updated)
> docker container ls -a

# create a container
> docker container create hello-world

# get the details of selected container
# > docker container inspect <container name or container id>
> docker container inspect c1c

# start already created container
> docker container start <container id or name>

# stop a running container
> docker container stop <container id or name>

# remove a stopped container
> docker container rm <container id or name>

# remove a running container
> docker container rm --force <container id or name>

```

```
# run the container
# create and start the container
# this command will run a new container every time
> docker container run <image name or id>

# set the name while running the application
# this container will run by default in attached mode
> docker container run --name <name> <image name or id>

# run the container in detached mode (background)
# -d: detached mode
# -i: enable the docker interactive mode
# -t: enable the teletype terminal for the docker
> docker container run --name <name> -itd <image name or id>

# enable port forwarding for a container
# source port
# - port allocated on OS
# - can be any available port
# container port
# - port exposed by the container
# > docker container run --name <name> -itd -p <source port>:<container port> <image name or id>
> docker container run --name myhttpd -itd -p 8080:80 httpd

# run mysql in a container
> docker container run --name mysql -itd -p 3306:3306 -e MYSQL_ROOT_PASSWORD=root mysql

# execute a command inside the container
# > docker container exec <container name or id> <command>
> docker container exec myhttpd date

# get the terminal from the container
# > docker container exec -it <container name or id> <shell>
> docker container exec -it myhttpd bash

# get the logs generated by the container
# > docker container logs <container name or id>
> docker container logs mysql

```

### Volume
```

# get the list of volumes
> docker volume ls

# remove the unused volumes
> docker volume prune

# create a volume
# - this will create a new directory name myvolume under /var/lib/docker/volumes
> docker volume create myvolume

# find more information about a volume
> docker volume inspect <volume name>

# remove a volume
> docker volume rm <volume name>

# attach volume to a container
# > docker container run --name <name> -itd -p <source port>:<container port> -v <volume name>:<mount point inside the container> <image name>
> docker container run --name mysql -itd -p 3306:3306 -v myvolume:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=root mysql

```
### images
```
customize the docker image to run your application by using **Dockerfile**
Dockerfile contains instructions/commands to create an image
commands
**FROM**
used to select the base image

**COPY**
used to copy file/directory from local machine to the image
e.g. COPY index.html /usr/local/apache2/htdocs/ will copy the index.html from local machine to the /usr/local/apache2/htdocs/ of image

**WORKDIR**
used to set the working directory
if the directory does not exist, the image creates this new directory

**RUN**
used to run a command while building an image
installing dependencies while building an image

**CMD**
used to run the command when container starts
this must be the last command of your Dockerfile

**EXPOSE**
used to expose a port for consumer to access the application running inside the container
```


```bash

# build a custom image
# > docker image build -t <image name>:<image tag> <context>
> docker image build -t myimage .

# login with docker credentials
> docker login -u <user name>

# create a new tag for your image to push to the docker hub
# > docker image tag <existing image> <docker username>/<image name>
> docker image tag myserver rishabh/myserver

# push the image to the docker hub
# > docker image push <image name>
> docker image push rishabh/myserver

# to build the image for other CPU architecture use buildx command
> docker buildx build --platform <platform> .


```